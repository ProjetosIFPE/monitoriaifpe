DROP DATABASE IF EXISTS PROJETO_PERIODO;
CREATE DATABASE PROJETO_PERIODO;
USE PROJETO_PERIODO;
DROP TABLE IF EXISTS PROJETO_PERIODO.USUARIO;
CREATE TABLE PROJETO_PERIODO.USUARIO (
	USUARIO_ID INTEGER,
	USUARIO_NOME VARCHAR(200),
	USUARIO_LOGIN VARCHAR(20),
	USUARIO_SENHA VARCHAR(40),
	USUARIO_EMAIL VARCHAR(50),
	PRIMARY KEY(USUARIO_ID)
);


DROP TABLE IF EXISTS PROJETO_PERIODO.CURSO;
CREATE TABLE PROJETO_PERIODO.CURSO (
	GRAU ENUM('SUPERIOR', 'TECNICO'),	
	CURSO_DS VARCHAR(20),
	PRIMARY KEY(CURSO_DS)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.DISCIPLINA;
CREATE TABLE PROJETO_PERIODO.DISCIPLINA ( 
	DISCIPLINA_CD INT NOT NULL AUTO_INCREMENT,
	DISCIPLINA_DS varchar(20),
	CURSO_DS VARCHAR(20) NOT NULL,
	PRIMARY KEY(DISCIPLINA_CD),
	FOREIGN KEY (CURSO_DS) REFERENCES CURSO(CURSO_DS)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.DEPARTAMENTO;
CREATE TABLE PROJETO_PERIODO.DEPARTAMENTO ( 
	DEPARTAMENTO_CD INT NOT NULL AUTO_INCREMENT,
	DEPARTAMENTO_DS VARCHAR(50),
	DEPARTAMENTO_DS_ABREV VARCHAR(20),
	PRIMARY KEY(DEPARTAMENTO_CD)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.ORIENTADOR;
CREATE TABLE PROJETO_PERIODO.ORIENTADOR( 
	ORIENTADOR_NOME VARCHAR(200),
	ORIENTADOR_SIAPE VARCHAR(20),
	DISCIPLINA_CD INT NOT NULL,
	PRIMARY KEY(ORIENTADOR_SIAPE),
	FOREIGN KEY(DISCIPLINA_CD) REFERENCES DISCIPLINA(DISCIPLINA_CD)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.FUNCIONARIO;
CREATE TABLE PROJETO_PERIODO.FUNCIONARIO ( 
	USUARIO_ID INTEGER NOT NULL,
	FUNCIONARIO_SIAPE VARCHAR(20),
	DEPARTAMENTO_CD INT NOT NULL,
	PRIMARY KEY (USUARIO_ID),
	FOREIGN KEY (DEPARTAMENTO_CD) REFERENCES DEPARTAMENTO(DEPARTAMENTO_CD),
	FOREIGN KEY (USUARIO_ID) REFERENCES USUARIO(USUARIO_ID)
);


DROP TABLE IF EXISTS PROJETO_PERIODO.ALUNO;
CREATE TABLE PROJETO_PERIODO.ALUNO (
	USUARIO_ID INTEGER NOT NULL,
	ALUNO_MATRICULA VARCHAR(20),
	CURSO_DS VARCHAR(20) NOT NULL,
	PRIMARY KEY (ALUNO_MATRICULA),
	FOREIGN KEY (CURSO_DS) REFERENCES PROJETO_PERIODO.CURSO(CURSO_DS),
	FOREIGN KEY (USUARIO_ID) REFERENCES PROJETO_PERIODO.USUARIO(USUARIO_ID)
);


DROP TABLE IF EXISTS PROJETO_PERIODO.DISCIPLINA_ALUNO;
CREATE TABLE PROJETO_PERIODO.DISCIPLINA_ALUNO ( 
	ALUNO_MATRICULA VARCHAR(20) NOT NULL,
	DISCIPLINA_CD INT NOT NULL,
	PRIMARY KEY (ALUNO_MATRICULA, DISCIPLINA_CD),
	FOREIGN KEY (ALUNO_MATRICULA) REFERENCES ALUNO(ALUNO_MATRICULA),
	FOREIGN KEY (DISCIPLINA_CD) REFERENCES DISCIPLINA(DISCIPLINA_CD)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.MONITOR;
CREATE TABLE PROJETO_PERIODO.MONITOR ( 
	ALUNO_MATRICULA VARCHAR(20),
	MODALIDADE ENUM('BOLSISTA', 'VOLUNTARIO'),
	DISCIPLINA_CD INT NOT NULL,
	PRIMARY KEY(ALUNO_MATRICULA),
	FOREIGN KEY(ALUNO_MATRICULA) REFERENCES ALUNO(ALUNO_MATRICULA),
	FOREIGN KEY(DISCIPLINA_CD) REFERENCES DISCIPLINA(DISCIPLINA_CD)
);



DROP TABLE IF EXISTS PROJETO_PERIODO.RELATORIO_FREQUENCIA;
CREATE TABLE PROJETO_PERIODO.RELATORIO_FREQUENCIA (
	RELATORIO_CD INT NOT NULL AUTO_INCREMENT,
	RELATORIO_ANO int(4),
	RELATORIO_MES int(2),
	RELATORIO_CARGA_HORARIA INT(2),
	ALUNO_MATRICULA VARCHAR(20) NOT NULL,
	RELATORIO_EDITAL VARCHAR(6),
	ORIENTADOR_SIAPE VARCHAR(20) NOT NULL,
	FUNCIONARIO_SIAPE VARCHAR(20) NOT NULL,
	DATA_ENTREGA DATE,
	PRIMARY KEY (RELATORIO_CD),
	FOREIGN KEY (ORIENTADOR_SIAPE) REFERENCES ORIENTADOR(ORIENTADOR_SIAPE),
	FOREIGN KEY (FUNCIONARIO_SIAPE) REFERENCES FUNCIONARIO(FUNCIONARIO_SIAPE),
    FOREIGN KEY (ALUNO_MATRICULA) REFERENCES MONITOR(ALUNO_MATRICULA)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.SEMANA;
CREATE TABLE PROJETO_PERIODO.SEMANA(
	SEMANA_CD INT NOT NULL AUTO_INCREMENT,
	SEMANA_DESCRICAO VARCHAR(200),
	SEMANA_OBS VARCHAR(200),
	RELATORIO_CD INT NOT NULL,
	PRIMARY KEY(SEMANA_CD),
	FOREIGN KEY (RELATORIO_CD) REFERENCES RELATORIO_FREQUENCIA(RELATORIO_CD)
);

DROP TABLE IF EXISTS PROJETO_PERIODO.ATIVIDADE;
CREATE TABLE PROJETO_PERIODO.ATIVIDADE (
	ATIVIDADE_CD INT NOT NULL AUTO_INCREMENT,
	ATIVIDADE_DATA DATE,
	HORARIO_ENTRADA VARCHAR(5),
	HORARIO_SAIDA VARCHAR(5),
	SEMANA_CD INT NOT NULL,
	PRIMARY KEY(ATIVIDADE_CD),
	FOREIGN KEY (SEMANA_CD) REFERENCES SEMANA(SEMANA_CD)
);

