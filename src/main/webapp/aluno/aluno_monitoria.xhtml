<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core" 
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:composition template="../_template.xhtml" >
        <ui:define name="conteudo">
            <p:tabView id="tabViewAlunoMonitoria">
                <p:tab title="Solicitação de Monitoria">
                    <h:outputText value="#{msg.turmasNaoOfertadas}" rendered="#{not alunoMonitoriaBean.possuiTurmasOfertadas()}" />
                    <h:form id="formMonitoria" rendered="#{alunoMonitoriaBean.possuiTurmasOfertadas()}">
                        <p:fieldset>
                            <h:panelGrid columns="2" cellspacing="10">    
                                <p:outputLabel>Turmas</p:outputLabel>
                                <p:selectOneMenu value="#{alunoMonitoriaBean.entidadeNegocio.turma}" converter="entidadeNegocioConverter" filter="true" effect="fade" filterMatchMode="startsWith">
                                    <f:selectItems value="#{alunoMonitoriaBean.turmas}" var="turma" itemLabel="#{turma.componenteCurricular.descricao}" itemValue="#{turma}" />
                                    <p:column style="width:10%">
                                        <h:outputText value="#{turma.periodo.ano}" />
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{turma.componenteCurricular.descricao}" />
                                    </p:column>
                                </p:selectOneMenu>
                            </h:panelGrid>
                            <p:separator />
                            <p:commandButton action="#{alunoMonitoriaBean.cadastrar()}" value="Solicitar Monitoria" ajax="false"  process="@form" update=":tabViewAlunoMonitoria:formMonitoriasSolicitadas" />
                        </p:fieldset>
                        
                    </h:form>
                </p:tab>
                <p:tab title="Monitorias Solicitadas">
                    <h:form id="formMonitoriasSolicitadas">
                        <p:fieldset>
                            <p:dataTable var="monitoria" value="#{alunoMonitoriaBean.monitoriasSolicitadas}" paginator="true" rows="5" emptyMessage="Não existem monitorias solicitadas.">

                                <f:facet name="header">
                                    Monitorias Solicitadas
                                </f:facet>

                                <p:column headerText="Turma" filterMatchMode="startsWith" filterBy="#{monitoria.turma.componenteCurricular.descricao}" sortBy="#{monitoria.turma.componenteCurricular.descricao}">             
                                    <div align="center"><h:outputText value="#{monitoria.turma.componenteCurricular.descricao}"/></div>
                                </p:column>

                                <p:column headerText="Período" filterMatchMode="startsWith" filterBy="#{monitoria.turma.periodo}" sortBy="#{monitoria.turma.periodo}" >      
                                    <div align="center"><h:outputText value="#{monitoria.turma.periodo}"/></div>
                                </p:column>

                                <p:column headerText="Situação" filterMatchMode="startsWith" filterBy="#{monitoria.situacaoMonitoria.label}}" sortBy="#{monitoria.situacaoMonitoria.label}}" >      
                                    <div align="center"> <h:outputText value="#{monitoria.situacaoMonitoria.label}"/></div>
                                </p:column>

                                <p:column>
                                    <div align="center">
                                        <p:commandLink styleClass="ui-icon ui-icon-trash"  action="#{alunoMonitoriaBean.remover(monitoria)}" >
                                            <p:confirm header="Confirmação" message="Tem certeza que deseja remover esta solicitação ?" icon="ui-icon-alert" />
                                        </p:commandLink>
                                    </div> 
                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                        <div align="center"> 
                                            <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </div> 
                                    </p:confirmDialog>
                                </p:column> 
                            </p:dataTable>
                        </p:fieldset>
                        <p:poll interval="10" listener="#{alunoMonitoriaBean.inicializarMonitoriasSolicitadas()}" update="@form" />
                    </h:form>
                </p:tab>
                <p:tab title="Monitorias Aprovadas">
                    <h:form>
                        <p:fieldset>
                            <p:dataTable var="monitoria" value="#{alunoMonitoriaBean.monitoriasAprovadas}" paginator="true" rows="5" emptyMessage="Não existem monitorias aprovadas.">

                                <f:facet name="header">
                                    Monitorias Aprovadas
                                </f:facet>

                                <p:column styleClass="icone-botao">             
                                    <div align="center">  
                                        <h:link   value="#{monitoria.chavePrimaria}" outcome="/aluno/atividade" styleClass="ui-icon ui-icon-search">
                                            <f:param name="monitoriaId" value="#{monitoria.chavePrimaria}"  />
                                        </h:link>   
                                    </div>                         
                                </p:column>
                                <p:column headerText="Turma" filterMatchMode="startsWith" filterBy="#{monitoria.turma.componenteCurricular.descricao}" sortBy="#{monitoria.turma.componenteCurricular.descricao}">             
                                    <div align="center"><h:outputText value="#{monitoria.turma.componenteCurricular.descricao}"/></div>
                                </p:column>

                                <p:column headerText="Período" filterMatchMode="startsWith" filterBy="#{monitoria.turma.periodo}">        
                                    <div align="center"><h:outputText value="#{monitoria.turma.periodo}"/></div>
                                </p:column>

                            </p:dataTable>
                        </p:fieldset>
                        <p:poll interval="10" listener="#{alunoMonitoriaBean.inicializarMonitoriasAprovadas()}" update="@form" />
                    </h:form>
                </p:tab>
            </p:tabView>
        </ui:define>

    </ui:composition>
</html>
